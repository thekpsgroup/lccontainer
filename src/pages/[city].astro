---
import { getCollection } from 'astro:content';
import BusinessHours from '../components/BusinessHours.astro';
import Header from '../components/Header.astro';
import RelatedContent from '../components/RelatedContent.astro';
import ProductSchema from '../components/seo/ProductSchema.astro';
import ServiceSchema from '../components/seo/ServiceSchema.astro';
import BaseLayout from '../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const cities = [
    { name: 'Dallas', slug: 'dallas' },
    { name: 'Fort Worth', slug: 'fort-worth' },
    { name: 'Arlington', slug: 'arlington' },
    { name: 'Plano', slug: 'plano' },
    { name: 'Irving', slug: 'irving' },
    { name: 'Garland', slug: 'garland' },
    { name: 'Grand Prairie', slug: 'grand-prairie' },
    { name: 'Mesquite', slug: 'mesquite' },
    { name: 'Richardson', slug: 'richardson' },
    { name: 'Carrollton', slug: 'carrollton' }
  ];

  return cities.map(city => ({
    params: { city: city.slug },
    props: { cityName: city.name, citySlug: city.slug }
  }));
}

const { cityName, citySlug } = Astro.props;

// Get all products for this city
const allPages = await getCollection('loc');
const cityPages = allPages.filter(page =>
  page.data.city && page.data.city.toLowerCase().includes(cityName.toLowerCase())
);

// Group by service type
const sales = cityPages.filter(p =>
  p.data.keyword && (p.data.keyword.includes('sale') || p.data.keyword.includes('buy'))
).slice(0, 12);

const rentals = cityPages.filter(p =>
  p.data.keyword && p.data.keyword.includes('rent')
).slice(0, 12);

const modifications = cityPages.filter(p =>
  p.data.cluster === 'container modifications'
).slice(0, 8);

const shipping = cityPages.filter(p =>
  p.data.keyword && p.data.keyword.includes('shipping container')
).slice(0, 8);

const storage = cityPages.filter(p =>
  p.data.keyword && p.data.keyword.includes('storage container')
).slice(0, 8);

const title = `Shipping & Storage Containers in ${cityName}, TX | LC Container`;
const description = `Containers in ${cityName}, TX. Buy, rent, or customize shipping containers. 20+ years serving DFW. Local delivery available. Call (214) 524-4168.`;
---

<BaseLayout title={title} description={description}>
  <!-- Enhanced Product Schema for city containers -->
  <ProductSchema container={{
    name: `${cityName} Shipping Containers`,
    description: `High-quality shipping containers available in ${cityName}, TX. New and used options for storage, construction, and custom applications.`,
    sku: `LC-${citySlug.toUpperCase()}-CONTAINER`,
    condition: "cargo-worthy",
    size: "20ft",
    availability: "InStock"
  }} />

  <!-- Service Schemas -->
  <ServiceSchema service={{
    name: `Container Delivery Service in ${cityName}`,
    description: `Professional container delivery service in ${cityName}, TX with same-day availability`,
    serviceType: "Container Delivery",
    areaServed: [cityName],
    priceRange: "$150-$500",
    duration: "Same Day",
    availableSchedule: "Monday-Friday 8AM-6PM, Saturday 9AM-5PM"
  }} />

  <Header />

  <section class="max-w-[1200px] mx-auto px-6 md:px-8 py-16 md:py-20">
    <!-- Hero Section -->
    <div class="text-center mb-12">
      <h1 class="text-4xl md:text-5xl font-bold mb-4 text-black">
        Shipping & Storage Containers in {cityName}
      </h1>
      <p class="text-lg text-grey-600 mb-6 max-w-3xl mx-auto">
        LC Container has been serving {cityName} since 2003. We offer new and used shipping containers,
        storage containers, and conex boxes for sale and rent with same-week delivery.
      </p>
      <div class="flex flex-wrap justify-center gap-4">
        <a
          href="tel:12145244168"
          class="px-8 py-3 bg-brand-red text-white font-bold hover:bg-brand-red-dark"
        >
          Call (214) 524-4168
        </a>
        <a
          href="/contact"
          class="px-8 py-3 border border-grey-300 bg-white text-black font-semibold hover:bg-grey-100"
        >
          Get Free Quote
        </a>
      </div>
    </div>

    <!-- Service Grid -->
    <div class="grid md:grid-cols-3 gap-8 mb-12">
      <!-- Buy Containers -->
      <div class="border border-grey-300 bg-white p-6">
        <h2 class="text-2xl font-bold mb-4 text-black">Buy Containers</h2>
        <p class="text-grey-600 mb-4">
          New & used containers available. Own it outright for your storage or modification needs.
        </p>
        <ul class="space-y-2 mb-4">
          {sales.slice(0, 8).map(page => (
            <li>
              <a
                href={`/${page.data.url_slug}`}
                class="text-brand-red hover:text-brand-red-dark text-sm"
              >
                {page.data.h1}
              </a>
            </li>
          ))}
        </ul>
        {sales.length > 8 && (
          <a href={`/${citySlug}/shipping-containers/sales`} class="text-brand-red font-semibold hover:text-brand-red-dark">
            View All Sales Options →
          </a>
        )}
      </div>

      <!-- Rent Containers -->
      <div class="border border-grey-300 bg-white p-6">
        <h2 class="text-2xl font-bold mb-4 text-black">Rent Containers</h2>
        <p class="text-grey-600 mb-4">
          Flexible rental terms from 1 month to long-term. Perfect for temporary storage needs.
        </p>
        <ul class="space-y-2 mb-4">
          {rentals.slice(0, 8).map(page => (
            <li>
              <a
                href={`/${page.data.url_slug}`}
                class="text-brand-red hover:text-brand-red-dark text-sm"
              >
                {page.data.h1}
              </a>
            </li>
          ))}
        </ul>
        {rentals.length > 8 && (
          <a href={`/${citySlug}/shipping-containers/rentals`} class="text-brand-red font-semibold hover:text-brand-red-dark">
            View All Rental Options →
          </a>
        )}
      </div>

      <!-- Custom Modifications -->
      <div class="border border-grey-300 bg-white p-6">
        <h2 class="text-2xl font-bold mb-4 text-black">Custom Modifications</h2>
        <p class="text-grey-600 mb-4">
          Convert containers into offices, workshops, storage units, and more.
        </p>
        <ul class="space-y-2 mb-4">
          {modifications.map(page => (
            <li>
              <a
                href={`/${page.data.url_slug}`}
                class="text-brand-red hover:text-brand-red-dark text-sm"
              >
                {page.data.h1}
              </a>
            </li>
          ))}
        </ul>
        {modifications.length > 0 && (
          <a href={`/${citySlug}/container-modifications`} class="text-brand-red font-semibold hover:text-brand-red-dark">
            View All Modifications →
          </a>
        )}
      </div>
    </div>

    <!-- Quick Info -->
    <div class="border border-grey-300 bg-grey-100 p-6 mb-12">
      <h3 class="text-2xl font-bold mb-3 text-black">Why Choose LC Container in {cityName}?</h3>
      <div class="grid md:grid-cols-2 gap-4">
        <ul class="space-y-2">
          <li class="flex items-start">
            <span class="text-brand-red mr-2 font-bold">✓</span>
            <span class="text-grey-600">20+ years serving the DFW area</span>
          </li>
          <li class="flex items-start">
            <span class="text-brand-red mr-2 font-bold">✓</span>
            <span class="text-grey-600">Same-week delivery to {cityName}</span>
          </li>
          <li class="flex items-start">
            <span class="text-brand-red mr-2 font-bold">✓</span>
            <span class="text-grey-600">New, used, and wind & water tight options</span>
          </li>
        </ul>
        <ul class="space-y-2">
          <li class="flex items-start">
            <span class="text-brand-red mr-2 font-bold">✓</span>
            <span class="text-grey-600">Flexible rental & purchase terms</span>
          </li>
          <li class="flex items-start">
            <span class="text-brand-red mr-2 font-bold">✓</span>
            <span class="text-grey-600">Custom modifications available</span>
          </li>
          <li class="flex items-start">
            <span class="text-brand-red mr-2 font-bold">✓</span>
            <span class="text-grey-600">Free delivery estimates</span>
          </li>
        </ul>
      </div>
    </div>

    <!-- Popular Container Types -->
    <div class="mb-12">
      <h2 class="text-3xl font-bold mb-6 text-black">Popular Container Types in {cityName}</h2>
      <div class="grid md:grid-cols-2 gap-6">
        <div class="border border-grey-300 bg-white p-6">
          <h3 class="text-xl font-bold mb-3 text-black">Shipping Containers</h3>
          <p class="text-grey-600 mb-4">
            Standard ISO shipping containers in 20ft and 40ft sizes. Perfect for storage, modifications, and shipping.
          </p>
          <ul class="space-y-2">
            {shipping.map(page => (
              <li>
                <a href={`/${page.data.url_slug}`} class="text-brand-red hover:text-brand-red-dark text-sm">
                  {page.data.h1}
                </a>
              </li>
            ))}
          </ul>
        </div>

        <div class="border border-grey-300 bg-white p-6">
          <h3 class="text-xl font-bold mb-3 text-black">Storage Containers</h3>
          <p class="text-grey-600 mb-4">
            Secure, weather-tight storage for residential and commercial use.
          </p>
          <ul class="space-y-2">
            {storage.map(page => (
              <li>
                <a href={`/${page.data.url_slug}`} class="text-brand-red hover:text-brand-red-dark text-sm">
                  {page.data.h1}
                </a>
              </li>
            ))}
          </ul>
        </div>
      </div>
    </div>

    <!-- CTA Section -->
    <div class="border border-grey-300 bg-black text-white p-8 text-center">
      <h2 class="text-3xl font-bold mb-4">Ready to Get Started?</h2>
      <p class="text-lg text-grey-300 mb-6">
        Get a free delivery estimate for {cityName} today!
      </p>
      <a
        href="tel:12145244168"
        class="inline-block px-8 py-4 bg-brand-red text-white font-bold text-lg hover:bg-brand-red-dark"
      >
        Call (214) 524-4168 Now
      </a>
      <p class="mt-4 text-grey-300">
        Or <a href="/contact" class="text-brand-red hover:text-brand-red-dark underline">request a quote online</a>
      </p>
    </div>

    <!-- Business Hours -->
    <div class="mt-12">
      <BusinessHours />
    </div>

    <!-- Related Content for Internal Linking -->
    <div class="mt-12">
      <RelatedContent
        currentPage={`Container Services in ${cityName}`}
        pageType="location"
        city={cityName}
        containerType="20ft"
        serviceType="delivery"
        tags={["containers", "storage", "delivery"]}
      />
    </div>

    <!-- SEO Text -->
    <div class="mt-12 prose max-w-none">
      <h2>Containers for {cityName}, Texas</h2>
      <p>
        LC Container is your trusted provider of shipping containers, storage containers, and conex boxes in {cityName}, TX.
        Since 2003, we've been helping businesses and homeowners across the Dallas-Fort Worth metroplex with quality containers
        at competitive prices.
      </p>
      <p>
        Whether you need to buy a container for permanent storage, rent one for a temporary project, or customize a container
        for a mobile office or workshop, we have the experience and inventory to meet your needs. We offer same-week delivery
        to {cityName} and can provide free site preparation consultations to ensure smooth delivery.
      </p>
      <p>
        All our containers are inspected for quality and come in various conditions to fit different budgets: one-trip (new)
        containers for pristine appearance, wind & water tight (WWT) containers for excellent value, and used containers for
        cost-effective storage.
      </p>
    </div>
  </section>
</BaseLayout>

<script type="application/ld+json">
{JSON.stringify({
  "@context": "https://schema.org",
  "@type": "LocalBusiness",
  "name": "LC Container",
  "image": "https://lccontainer.com/photos/logos/lc-container-logo.png",
  "@id": "https://lccontainer.com",
  "url": "https://lccontainer.com",
  "telephone": "+1-214-524-4168",
  "priceRange": "$$",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "1211 E Fulghum Rd",
    "addressLocality": "Hutchins",
    "addressRegion": "TX",
    "postalCode": "75141",
    "addressCountry": "US"
  },
  "areaServed": {
    "@type": "City",
    "name": cityName
  },
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": 32.6487,
    "longitude": -96.7083
  },
  "openingHoursSpecification": {
    "@type": "OpeningHoursSpecification",
    "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
    "opens": "08:00",
    "closes": "17:00"
  },
  "sameAs": [
    "https://www.facebook.com/lccontainer",
    "https://www.instagram.com/lccontainer"
  ]
})}
</script>
