---
export interface Props {
  currentPage: string;
  pageType: "product" | "service" | "location" | "guide" | "inventory";
  containerType?: string;
  city?: string;
  serviceType?: string;
  tags?: string[];
}

const {
  currentPage,
  pageType,
  containerType = "",
  city = "",
  serviceType = "",
  tags = [],
} = Astro.props;

// Define related content mappings
const getRelatedLinks = (
  type: string,
  containerType: string,
  city: string,
  serviceType: string
) => {
  const baseLinks = {
    product: [
      {
        href: "/services/container-delivery/",
        text: "Delivery Options",
        description: "Same-day delivery throughout Texas",
      },
      {
        href: "/services/container-modifications/",
        text: "Modification Services",
        description: "HVAC, electrical, windows, and doors",
      },
      {
        href: "/guides/buying-guide/",
        text: "Container Buying Guide",
        description: "How to choose the right container",
      },
    ],
    service: [
      {
        href: "/inventory/",
        text: "Browse All Containers",
        description: "View our complete inventory",
      },
      {
        href: "/service-areas/",
        text: "Service Areas",
        description: "Where we deliver containers",
      },
      {
        href: "/faq/",
        text: "Frequently Asked Questions",
        description: "Get answers to common questions",
      },
    ],
    location: [
      {
        href: "/inventory/",
        text: "Available Containers",
        description: "See what containers we have in stock",
      },
      {
        href: "/services/",
        text: "Our Services",
        description: "Full range of container services",
      },
      {
        href: "/services/container-delivery/",
        text: "Delivery Information",
        description: "Learn about our delivery process",
      },
    ],
    inventory: [
      {
        href: "/services/container-modifications/",
        text: "Container Modifications",
        description: "Customize your container",
      },
      {
        href: "/services/container-delivery/",
        text: "Delivery Service",
        description: "Professional container delivery",
      },
      {
        href: "/guides/size-guide/",
        text: "Size Comparison Guide",
        description: "Compare container sizes",
      },
    ],
    guide: [
      {
        href: "/inventory/",
        text: "View Available Containers",
        description: "Browse our current inventory",
      },
      {
        href: "/contact/",
        text: "Get Expert Advice",
        description: "Speak with our container experts",
      },
      {
        href: "/services/",
        text: "Our Services",
        description: "Complete container solutions",
      },
    ],
  };

  let links = baseLinks[type as keyof typeof baseLinks] || [];

  // Add contextual links based on container type
  if (containerType) {
    if (containerType.includes("20ft")) {
      links.push({
        href: "/inventory/40std-new/",
        text: "40ft Container Options",
        description: "Compare with larger containers",
      });
    } else if (containerType.includes("40ft")) {
      links.push({
        href: "/inventory/20std-new/",
        text: "20ft Container Options",
        description: "Compare with smaller containers",
      });
    }
  }

  // Add city-specific links
  if (city) {
    const citySlug = city.toLowerCase().replace(/[^a-z0-9]/g, "-");
    links.push({
      href: `/${citySlug}/`,
      text: `Containers in ${city}`,
      description: `Local container services in ${city}`,
    });
  }

  return links.slice(0, 6); // Limit to 6 related links
};

const relatedLinks = getRelatedLinks(
  pageType,
  containerType,
  city,
  serviceType
);

// Popular container sizes for cross-selling
const popularContainers = [
  {
    href: "/inventory/20std-new/",
    text: "20ft New Containers",
    price: "From $4,500",
  },
  {
    href: "/inventory/20std-used/",
    text: "20ft Used Containers",
    price: "From $3,200",
  },
  {
    href: "/inventory/40std-new/",
    text: "40ft New Containers",
    price: "From $6,500",
  },
  {
    href: "/inventory/40hc-new/",
    text: "40ft High Cube",
    price: "From $7,200",
  },
];

// Popular service areas for location cross-linking
const serviceAreas = [
  { href: "/dallas/", text: "Dallas Containers" },
  { href: "/fort-worth/", text: "Fort Worth Containers" },
  { href: "/arlington/", text: "Arlington Containers" },
  { href: "/plano/", text: "Plano Containers" },
];
---

<div class="related-content-section">
  <!-- Main Related Content -->
  <section
    class="related-content bg-white/50 dark:bg-brand-black/20 backdrop-blur-sm rounded-xl border border-brand-line/20 p-6 mb-8"
  >
    <h2
      class="text-xl font-semibold text-ink-primary mb-4 flex items-center gap-2"
    >
      <svg
        class="w-5 h-5 text-brand-red"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"
        ></path>
      </svg>
      Related Information
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {
        relatedLinks.map(
          (link: { href: string; text: string; description: string }) => (
            <a
              href={link.href}
              class="related-link-card group p-4 bg-white dark:bg-brand-black/40 rounded-lg border border-brand-line/20 hover:border-brand-red/30 hover:shadow-md transition-all duration-200"
            >
              <h3 class="font-semibold text-ink-primary group-hover:text-brand-red transition-colors duration-200 mb-1">
                {link.text}
              </h3>
              <p class="text-sm text-ink-muted group-hover:text-ink-secondary transition-colors duration-200">
                {link.description}
              </p>
            </a>
          )
        )
      }
    </div>
  </section>

  <!-- Popular Containers Section -->
  {
    pageType !== "inventory" && (
      <section class="popular-containers bg-gradient-to-r from-blue-50 to-green-50 dark:from-blue-900/20 dark:to-green-900/20 rounded-xl border border-brand-line/20 p-6 mb-8">
        <h2 class="text-xl font-semibold text-ink-primary mb-4 flex items-center gap-2">
          <svg
            class="w-5 h-5 text-brand-red"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
            />
          </svg>
          Popular Container Options
        </h2>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
          {popularContainers.map((container) => (
            <a
              href={container.href}
              class="container-card group bg-white dark:bg-brand-black/40 rounded-lg border border-brand-line/20 hover:border-brand-red/30 hover:shadow-lg transition-all duration-200 p-4"
            >
              <h3 class="font-semibold text-ink-primary group-hover:text-brand-red transition-colors duration-200 mb-2">
                {container.text}
              </h3>
              <p class="text-sm font-medium text-green-600 dark:text-green-400">
                {container.price}
              </p>
              <p class="text-xs text-ink-muted mt-1">Call for exact pricing</p>
            </a>
          ))}
        </div>
      </section>
    )
  }

  <!-- Service Areas Section -->
  {
    pageType !== "location" && (
      <section class="service-areas bg-gradient-to-r from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 rounded-xl border border-brand-line/20 p-6">
        <h2 class="text-xl font-semibold text-ink-primary mb-4 flex items-center gap-2">
          <svg
            class="w-5 h-5 text-brand-red"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
            />
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
            />
          </svg>
          We Serve These Areas
        </h2>

        <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
          {serviceAreas.map((area) => (
            <a
              href={area.href}
              class="area-link group bg-white dark:bg-brand-black/40 rounded-lg border border-brand-line/20 hover:border-brand-red/30 hover:shadow-md transition-all duration-200 p-3 text-center"
            >
              <span class="text-sm font-medium text-ink-primary group-hover:text-brand-red transition-colors duration-200">
                {area.text}
              </span>
            </a>
          ))}
        </div>

        <div class="mt-4 text-center">
          <p class="text-sm text-ink-muted mb-3">
            Serving 200+ mile radius from our Hutchins facility
          </p>
          <a
            href="/contact/"
            class="inline-flex items-center gap-2 bg-brand-red hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200 text-sm"
          >
            <svg
              class="w-4 h-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
              />
            </svg>
            Check Service to Your Area
          </a>
        </div>
      </section>
    )
  }
</div>

<style>
  .related-content-section {
    @apply mt-12;
  }

  .related-link-card:hover {
    @apply transform translate-y-[-2px];
  }

  .container-card:hover {
    @apply transform translate-y-[-2px];
  }

  .area-link:hover {
    @apply transform translate-y-[-1px];
  }
</style>
