---
const nav = [
  { href: "/", label: "Home" },
  { href: "/services", label: "Services" },
  { href: "/inventory", label: "Inventory" },
  { href: "/about", label: "About" },
  { href: "/contact", label: "Contact" }
];
---
<header class="sticky top-0 z-50 border-b border-brand-line/40 bg-white/60 dark:bg-brand-black/80 backdrop-blur-xl shadow-lg transition-all duration-300" id="header">
  <div class="max-w-[1200px] mx-auto px-5 flex h-20 items-center justify-between">
    <a href="/" class="flex items-center gap-3">
      <img src="/photos/lccontainer-dark.png" alt="LC Container" class="h-9 w-auto" />
      <span class="sr-only">LC Container</span>
    </a>

    <nav class="hidden md:flex items-center gap-10">
      {nav.map(i => (
        <a
          href={i.href}
          data-astro-prefetch
          class="text-base font-semibold text-ink-muted hover:text-brand-red focus:outline-none focus:ring-2 focus:ring-brand-silver/60 rounded transition-colors duration-200 tracking-wide px-2 py-1"
        >
          {i.label}
        </a>
      ))}
    </nav>

    <div class="hidden md:flex items-center gap-5">
      <a href="tel:12145244168" class="text-base text-ink-muted hover:text-brand-red font-medium transition-colors">Call (214) 524-4168</a>
      <a
        href="/contact"
        data-astro-prefetch
        class="px-6 py-2 rounded-2xl bg-brand-red text-white text-base font-bold shadow-md hover:bg-brand-black/90 hover:scale-105 transition-all focus:outline-none focus:ring-2 focus:ring-brand-silver/60"
      >
        Get Free Quote
      </a>
    </div>

    <!-- Mobile Menu -->
    <div class="md:hidden">
      <button
        id="mobile-menu-button"
        class="p-3 rounded-xl bg-white/70 dark:bg-brand-black/80 shadow hover:bg-white/90 dark:hover:bg-brand-black/90 focus:outline-none focus:ring-2 focus:ring-brand-silver/60 transition-all"
        aria-label="Toggle mobile menu"
        aria-expanded="false"
      >
        <span class="block w-6 h-0.5 bg-brand-black dark:bg-white mb-1 rounded"></span>
        <span class="block w-6 h-0.5 bg-brand-black dark:bg-white mb-1 rounded"></span>
        <span class="block w-6 h-0.5 bg-brand-black dark:bg-white rounded"></span>
      </button>

      <div
        id="mobile-menu"
        class="hidden absolute right-4 mt-3 w-80 glass p-8 shadow-2xl rounded-2xl border border-brand-line/20 bg-white/90 dark:bg-brand-black/90"
        role="menu"
        aria-labelledby="mobile-menu-button"
      >
        <nav class="space-y-2" role="none">
          {nav.map(i => (
            <a
              class="block py-3 px-5 rounded-lg hover:bg-brand-red/10 text-ink font-semibold focus:outline-none focus:ring-2 focus:ring-brand-silver/60 transition-colors"
              href={i.href}
              data-astro-prefetch
              role="menuitem"
            >
              {i.label}
            </a>
          ))}
        </nav>
        <div class="mt-8 pt-4 border-t border-brand-line/10 space-y-4">
          <a
            href="tel:12145244168"
            class="block text-base text-ink-muted hover:text-brand-red py-2 font-medium"
            role="menuitem"
          >
            Call (214) 524-4168
          </a>
          <a
            href="/contact"
            data-astro-prefetch
            class="block w-full py-3 px-5 rounded-2xl bg-brand-red text-white text-base font-bold text-center shadow hover:bg-brand-black/90 focus:outline-none focus:ring-2 focus:ring-brand-silver/60 transition-all"
            role="menuitem"
          >
            Get Free Quote
          </a>
        </div>
      </div>
    </div>
  </div>
</header>

<script>
  // Header scroll blur effect
  const header = document.getElementById('header');
  let ticking = false;

  const updateHeader = () => {
    const currentScrollY = window.scrollY;

    if (currentScrollY > 30) {
      header?.classList.add('bg-brand-black/95', 'backdrop-blur-md');
    } else {
      header?.classList.remove('bg-brand-black/95', 'backdrop-blur-md');
    }

    ticking = false;
  };

  window.addEventListener(
    'scroll',
    () => {
      if (!ticking) {
        requestAnimationFrame(updateHeader);
        ticking = true;
      }
    },
    { passive: true }
  );

  // Mobile menu functionality
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');

  if (mobileMenuButton && mobileMenu) {
    let isOpen = false;

    const toggleMenu = () => {
      isOpen = !isOpen;
      mobileMenu.classList.toggle('hidden', !isOpen);
      mobileMenuButton.setAttribute('aria-expanded', isOpen.toString());

      // Close menu when clicking outside
      if (isOpen) {
        const closeMenu = (e: MouseEvent) => {
          if (!mobileMenu.contains(e.target as Node) && !mobileMenuButton.contains(e.target as Node)) {
            mobileMenu.classList.add('hidden');
            mobileMenuButton.setAttribute('aria-expanded', 'false');
            isOpen = false;
            document.removeEventListener('click', closeMenu);
            document.removeEventListener('keydown', handleEscape);
          }
        };

        const handleEscape = (e: KeyboardEvent) => {
          if (e.key === 'Escape') {
            mobileMenu.classList.add('hidden');
            mobileMenuButton.setAttribute('aria-expanded', 'false');
            isOpen = false;
            document.removeEventListener('click', closeMenu);
            document.removeEventListener('keydown', handleEscape);
          }
        };

        setTimeout(() => {
          document.addEventListener('click', closeMenu);
          document.addEventListener('keydown', handleEscape);
        }, 10);
      }
    };

    mobileMenuButton.addEventListener('click', toggleMenu);
  }
</script>
